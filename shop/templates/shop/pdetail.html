{% extends 'base.html' %}
{% load i18n static %}
{% block title %}{% trans 'Buy' %} {{ object.name }}{% endblock %}
{% comment %}<!--<source src="{{ object.video.url }}" type="video/ogg"> Fallback if the browser doesn't support video tagmuted width="560" height="315"{ % for img in object.img.all %}
{ % if img.is_feature %}<img src="{{ img.url }}" alt="{{ img.alt_text }}">
{% endif %}{% endfor %} x-bind:value="{{ q }}"-->{% endcomment %}
{% block content %}
<div id="productapp" class="font-c-sans text-lg lg:flex space-y-8 lg:space-y-0 lg:space-x-6">
  <div class="lg:w-2/5">
    {% if object.video %}
    <video loading="lazy" class="rounded-lg bord shadow" controls>
      <source src="{{ object.video.url }}" type="video/mp4">
      <embed src="{flash_swf_file}.swf" type="application/x-shockwave-flash"></embed>
    </video>
    {% elif object.video_link %}
    <iframe src="{{ object.video_link }}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
    {% elif object.img %}
    <div id="pic" class="hidden lg:block">
      <img loading="lazy" src="{{ object.img.url }}" alt="{{ object.name }} {% trans 'Image' %}" class="bord rounded-xl shadow mx-auto">
    </div>
    <img loading="lazy" src="{{ object.img.url }}" alt="{{ object.name }} {% trans 'Image' %}" class="block lg:hidden bord rounded-xl shadow mx-auto">
    {% else %}
    <svg class="text-gray-400 fill-current lg:w-28 lg:h-28 mx-auto"><use xlink:href="{% static 'img/svg-defs.svg' %}#clogo"></use></svg>
    {% endif %}
  </div>
  <div class="lg:w-2/5 w-full">
    <h1 class="text-2xl">{{ object.name }}</h1>
    <div class="list-inside mt-2">
      {{ object.text|safe|linebreaks }}
    </div>
  </div>
  <div class="lg:w-1/5 text-right items-center space-y-6 m-auto">
{% comment %}<!-- x-data="{ qty: '1' }" <div class="text-left inline-flex items-center">
  {% if object.is_digital %}
  <p>{% trans 'Digital' %}</p>
  {% else %}
  <label for="id_qty" class="mr-2">{% trans 'Quantity' %}:</label>
  <select id="id_qty" @change="qty = $event.target.value" name="qty">
    {% for q in object.rangeqty %}
    <option value="{{ q }}">{{ q }}</option>
    {% endfor %}
  </select>
  {% endif %}
</div> <p x-show="qty > 1" x-text="'&#215;' + qty" class="text-gray-500 text-sm"></p>{ % include 'shop/snippets/update-cart.html' with product=object cart=cart %} justify-between {% include 'base/snippets/backbtn.html' with url=shop_url id=object.slug %}-->{% endcomment %}
    <div class="mr-1">
      <p>{% if user.currency == "USD" %}${% else %}â‚¬{% endif %}{{ object.price }}</p>
    </div>
    <div class="inline-flex items-center">
      <!-- <form method="post" action="{{ update_cart_url }}" data-endpoint="{{ update_cart_url }}" enctype="multipart/form-data" class="form-product-aja x"{% if request.user.is_authenticated %} data-user="abc"{% endif %}> { % csrf_token %} -->
        <!-- <input type="hidden" name="product_id" value="{{ object.id }}"{% if  product.is_digital %} data-is-digital="true"{% endif%}> -->
        <!-- <span class="submit-span"> -->
        <!-- { % if object in cart.products.all %} -->
          <a v-if="added" href="{{ cart_url }}" class="upcart">
            <svg class="fill-current w-4 h-4 mr-2"><use xlink:href="{% static 'img/svg-defs.svg' %}#cart"></use></svg> {% trans 'In Cart' %}
          </a>
          <!-- { % else %} -->
          <button v-else @click="addItem({{ object.id }})" class="upcart">
            <svg class="fill-current w-4 h-4 mr-2"><use xlink:href="{% static 'img/svg-defs.svg' %}#cart"></use></svg> {% trans 'Add to Cart' %}
          </button>
        <!-- { % endif %} -->
        <!-- </span> -->
      <!-- </form> -->
      {% comment %}<!-- { % if object in cart.products.all %}
      <a href="{{ cart_url }}" class="upcart">
        <svg class="fill-current w-4 h-4 mr-2"><use xlink:href="{% static 'img/svg-defs.svg' %}#cart"></use></svg> {% trans 'In Cart' %}
      </a>
      {% else %}
      <button @click="addItem({{ object.id }})" class="upcart">
        <svg class="fill-current w-4 h-4 mr-2"><use xlink:href="{% static 'img/svg-defs.svg' %}#cart"></use></svg>
        [[ btn.text ]]
      </button>
      {% endif %} -->{% endcomment %}
    </div>
  </div>
</div>
{% endblock %}
{% block js %}
<script>
  var productapp = new Vue({
    el: '#productapp',
    delimiters: ['[[', ']]'],
    store: store,
    data () {
      return {
        added: false,
        // showMessage: false,
        // mainImage: '{{ object.img.url }}',
        images: ['{{ imagesstring|safe }}']// add slideshow or just add one 360 slow gif.video
      }
    },
    methods: {
      addItem(productId) {
        var data = {
          'product_id': productId,
          'update': false,
          'quantity': 1// add qty btn
        };
        fetch('/cart/update/', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': '{{ csrf_token }}'
          },
          credentials: 'same-origin',
          body: JSON.stringify(data)
        })
        .then((response) => {
          // this.showMessage = true;
          // console.log("Added");
          this.added = true;
          store.commit('updateNrItems', 1);
          // setTimeout(() => {this.showMessage = false}, 2000)
        })
        .catch(function (error) {
          console.log(error);
        })
      }
      //, changeMessage() {
      // },
      // changeMainImage(img) {
      //   this.mainImage = img;
      // },
    }
  });
  var opt = {
    fillContainer: true,
    offset: {vertical: 0, horizontal: 15}
  };
  new ImageZoom(document.getElementById("pic"), opt);
</script>
{% endblock %}{% comment %}<!--var options1 = {
    width: 400,
    zoomWidth: 500,
    offset: {vertical: 0, horizontal: 10}
  };
  // If the width and height of the image are not known or to adjust the image to the container of it
$(document).ready(function() {$('#id_qty option:selected').text();})
&times;
custom_tags https://turingpi.com/ add video/gif Your browser does not support the video tag. 2E3A47 313A45 171717 cbd5e0 a0aec0 EEEEEE F39C12 FCEBB6 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)
{ % block css %}<style>
#pic{
  /* max-width: 500px;
  max-height: 600px; */
  /* border: 2px solid black; */
  /* cursor: pointer;} */
#img-div{
  z-index: 1;
  /* max-width: 400px;
  max-height: 300px; */
  position: relative;
}
#zum{
  z-index: 2;
  position: absolute;
  height: 180px;
  width: 180px;
  border:1px solid black;
  background-repeat: no-repeat;
  cursor: none;
}</style>{ % endblock %}
Add 360 gif or slideshow { % if not object.is_digital %}<div id="zum" class="hidden xl:block"></div>{ % endif %}
<script>
  $(document).on('click', '#buybtn', function (e) {
    e.preventDefault();
    $.ajax({
      type: 'POST',
      url: '{{ update_cart_url }}',
      data: {
        productid: $('#product_id').val(),
        productqty: $('#qty-id option:selected').text(),
        csrfmiddlewaretoken: "{{csrf_token}}",
        action: 'post'
      },
      success: function (json) {
        document.getElementById("basket-qty").innerHTML = json.qty
      },
      error: function (xhr, errmsg, err) { }
    });
  })
</script>
<script type="text/javascript" src="{ % static 'js/zum.js' %}"></script>url: "{ % url 'cart:cart_add' %}", 
<script>
$(document).on('click', '#buybtn', function(e) {
  e.preventDefault();
  $.ajax({
    type: 'POST',
    data: {
      productid: $('#product_id').val(),
      productqty: $('#id_qty option:selected').text(),
      csrfmiddlewaretoken: '{% csrf_token %}',
      action: 'post's
    },
    success: function(json) {
      console.log(json)
    },
    error: function(xhr, errmsg, err) {
    }
  })
})</script>-->{% endcomment %}