{% extends 'base.html' %}
{% load i18n static %}
{% block title %}{% trans 'Revenues' %}{% endblock %}
{#<!-- Add currency converter, company-default-currency * exchange rate -->#}
{% block content %}
<div class="font-c-sans max-w-lg mx-auto">
  <div class="flex justify-between">
    <h1 class="text-2xl font-semibold">{% trans 'Revenue' %} ðŸ“ˆ</h1>
    <div class="relative">
      <select name="currency" id="currency"
        class="rounded-lg shadow appearance-none w-full border border-gray-300 focus:border-yellow-500 bg-white focus:ring-2 focus:ring-yellow-200 focus:ring-offset-transparent focus:ring-offset-2 px-2 pr-5 py-1">
        <option value="EUR">EUR</option>
        {# <!--â‚¬ <option value="USD">US$</option> -->#}
      </select>
      <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-1 text-gray-600">
        <svg class="fill-current h-4 w-4">
          <use xlink:href="{% static 'img/svg-defs.svg' %}#arrow-d"></use>
        </svg>
      </div>
    </div>
  </div>
  <div class="space-y-4">
    <div class="border-t border-gray-300 pt-3 mt-3">
      <h3 class="text-lg">{% trans 'Current week revenue' %}:
        <span class="bg-yellow-300 ml-1">{% include 'carts/snippets/currency.html' %}
          {% if this_week.recent_data.total__sum %}{{ this_week.recent_data.total__sum }}
          {% else %}0{% endif %}
        </span>
      </h3>
      {% if this_week.recent %}
      <div x-data="{ open: false }">
        <div class="text-center mt-4 mb-5">
          <button @click="open=!open" class="text-sm bg-white focus:outline-none items-center border-2 border-yellow-300 shadow p-2 leading-non rounded-xl" type="button">
            <span x-show="!open">{% trans 'Show recent' %}</span>
            <span x-show="open">{% trans 'Hide' %}</span>
          </button>
        </div>
        <table x-show="open" class="text-left table-auto mx-auto">
          <thead class="border-b border-gray-500">
            <tr>
              <th scope="col" colspan="1">{% trans 'Order' %} ID</th>
              <th scope="col" colspan="1" class="px-4">{% trans 'Revenue' %}</th>
              <th scope="col" colspan="1">{% trans 'Date' %}</th>
            </tr>
          </thead>
          <tbody>
          {% for o in this_week.recent %}
            <tr class="{% if not forloop.last %}border-b border-gray-300{% endif %}">
              <td>{{ o.order_id }}</td>
              <td class="px-4">{% include 'carts/snippets/currency.html' %}{{ o.total }}</td>
              <td>{{ o.updated_at|date:'Y-m-d, G:i' }}</td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
        <div class="bg-white p-1 rounded-lg border border-gray-400 shadow mt-4">
          <canvas class="render-saleschart" id="thisWeekSales" data-type='week' width="400" height="400"></canvas>
        </div>
      </div>
      {% endif %}
    </div>
    <div class="border-t border-gray-300 pt-3 mt-4">
      <p class="text-lg pb-1">{% trans 'Previous 4 weeks' %}</p>
      <p>{% trans 'Orders total' %}: {% include 'carts/snippets/currency.html' %}
        {% if last_four_weeks.recent_data.total__sum %}{{ last_four_weeks.recent_data.total__sum }}{% else %}0{% endif %}
      </p>
      <p>{% trans 'Shipped total' %}: {% include 'carts/snippets/currency.html' %}
        {% if last_four_weeks.shipped_data.total__sum %}{{ last_four_weeks.shipped_data.total__sum }}{% else %}0{% endif %}
      </p>
      <p>{% trans 'Paid total' %}: {% include 'carts/snippets/currency.html' %}
        {% if last_four_weeks.paid_data.total__sum %}{{ last_four_weeks.paid_data.total__sum }}{% else %}0{% endif %}
      </p>
    </div>
    <div class="bg-white p-1 rounded-lg border border-gray-400 shadow mt-3">
      <canvas class="render-saleschart" id="4weekSales" data-type="4weeks" width="400" height="400"></canvas>
    </div>
  </div>
</div>
{% endblock%}
{% comment %}<!-- <div class="border-t border-gray-300 pt-3 mt-3">
  <h3 class="text-lg">{% trans "Revenue at" %} {% now 'Y-m-d' %}:
    {% include 'carts/snippets/currency.html' %}{% if today.recent_data.total__sum %}{{ today.recent_data.total__sum }}{% else %}0{% endif %}
  </h3>
  {% if today.recent %}
  <div x-data="{ open: false }">
    <div class="text-center mt-4 mb-5">
      <button @click="open=!open"
        class="text-sm bg-white focus:outline-none items-center border-2 border-yellow-300 shadow p-2 leading-none rounded-lg"
        type="button">
        <span x-show="!open">{% trans 'Show recent' %}</span>
        <span x-show="open">{% trans 'Hide' %}</span>
      </button>
    </div>
    <table x-show="open" class="text-left table-auto mx-auto">
      <thead class="border-b border-gray-500">
        <tr>
          <th scope="col" colspan="1">{% trans 'Order' %} ID</th>
          <th scope="col" colspan="1" class="px-4">{% trans 'Revenue' %}</th>
          <th scope="col" colspan="1">{% trans 'Date' %}</th>
        </tr>
      </thead>
      <tbody>
      {% for o in today.recent %}{#<!-|slice:':5'D j, G:i->#}
        <tr class="{% if not forloop.last %}border-b border-gray-300{% endif %}">
          <td>{{ o.order_id }}</td>
          <td class="px-4">{% include 'carts/snippets/currency.html' %}{{ o.total }}</td>
          <td>{{ o.updated_at|time:'Y-m-d, G:i' }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
  {% endif %}
</div>
<ul>
  { % for order in this_week.recent|slice:':5' %}
  <li>
    <p>{% trans 'Order' %} ID: {{ order.order_id }}
    {% include 'carts/snippets/currency.html' %}{{ order.total }}
    {{ order.updated_at|timesince }} {% trans 'ago' %}</p>
  </li>
  {% endfor %}
</ul>
&#x24; &#36; $ &#x20AC; &#8364; { % if user.currency == None or user.currency == '$' % }$ {{ last_four_weeks.paid_data.total__sum }}
{ % elif user.currency == 'Â£' % }{{ user.currency }} {{ last_four_weeks.paid_data.total__sum }}
{ % elif user.currency == 'â‚¬' % }{{ last_four_weeks.paid_data.total__sum }} {{ user.currency }}{ % endif % }-->{% endcomment %}